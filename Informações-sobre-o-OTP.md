O OTP é uma região de 0x100 bytes de dados aparentemente aleatórios no endereço 0x10012000. Presume-se que as chaves únicas do console são derivadas desta região, porém, atualmente não se sabe como. Esta região provavelmente é o armazenamento de dados únicos do console que é decriptado pela bootrom, mas não saberemos como isto é feito até que alguém consiga extrair a bootrom protegida e completa. Até o momento não se sabe se alguém já conseguiu extrair a bootrom protegida.

Antes da versão 3.0.0-X do firmware, a região 0x10012000 (o OTP) ficava desprotegida e poderia ser extraída por um atacante com permissões de execução de código arm9.

Depois da versão 3.0.0-X, a Nintendo começou a trancar esta região usando o registro CFG_SYSPROT9, que também trava o bootloader e é definido no começo do boot, muito antes que consigamos execução de código. Este registro pode ser definido exatamente uma vez e não pode ser desligado até que o sistema seja desligado completamente. Deste modo, faz-se impossível a extração do OTP completo sem um sistema de versão 2.1.0-X ou inferior.

Existe, porém, um método para extrair o hash do OTP na versão 9.6.0-X. Como o Kernel9Loader não limpa o registro SHA_HASH depois que ele é utilizado, extrair este registro nos dará o hash do OTP que foi entregue ao Kernel9 pelo Kernel9Loader. Além disso, existe há já muito tempo uma vulnerabilidade com a qual um reboot MCU causado pelo i2c não limpará a RAM como deveria.

Isto permite um ataque baseado em hardware onde dados arbitrários são escritos ao nand_sector96+0x10 de um backup da SysNAND e este é escrito no console. Depois, liga-se o i2c ao reboot MCU via comando, escreve-se um pacote (que escreverá 0x1000A040 - 0x1000A060 a um arquivo no cartão SD) em algum lugar da memória arm9, enche-se a memória com um NOP slide seguido de uma instrução JMP apontando para o pacote. Por fim, pode-se realizar o reboot MCU repetidamente (incrementando o nand_sector96+0x10 em 1 cada vez) até que o Kernel9Loader pule para o pacote aleatoriamente.

Por causa da complexidade e do hardware adicional necessário para realizar o método descrito acima, decidi limitar o escopo deste guia estritamente ao método baseado em software para realizar downgrade para um firmware inferior à versão 3.0.0-X. A versão 2.1.0-X foi escolhida porque é a única versão inferior à versão 3.0.0-X que contém uma versão de browser completamente vulnerável (a versão 2.0.0-X tem um browser parcialmente vulnerável, mas não funcionará por outras razões).

A seção sobre OTP deste guia o guiará através do processo de downgrade da RedNAND para a versão 2.1.0-X para garantir que você não realizará um downgrade parcial (quando alguns títulos do sistema estão em uma versão e outros estão em outra), que é algo difícil de consertar. No New 3DS você deverá então decriptá-lo com o xorpad 0x5 do console (que só existe no New 3DS) e então reencriptá-lo com o xorpad 0x4 do console. Depois, você sobrescreverá o NAND NCSD (o header que especifica o local de cada partição) do New 3DS com o NCSD de um 3DS Original e gravará a RedNAND para a SysNAND. Estes passos não são necessários no 3DS Original.